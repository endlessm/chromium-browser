{"version":3,"sources":["javascript/class-scanner.ts"],"names":[],"mappings":"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","file":"class-scanner.js","sourcesContent":["/**\n * @license\n * Copyright (c) 2015 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport * as doctrine from 'doctrine';\nimport * as estree from 'estree';\n\nimport {ScannedClass, ScannedFeature, ScannedMethod, ScannedProperty, ScannedReference, Severity, SourceRange, Warning} from '../model/model';\nimport {extractObservers} from '../polymer/declaration-property-handlers';\nimport {Observer, ScannedPolymerElement} from '../polymer/polymer-element';\nimport {ScannedPolymerElementMixin} from '../polymer/polymer-element-mixin';\nimport {getIsValue, getPolymerProperties, getStaticGetterValue} from '../polymer/polymer2-config';\nimport {MixinVisitor} from '../polymer/polymer2-mixin-scanner';\n\nimport * as astValue from './ast-value';\nimport {getIdentifierName, getNamespacedIdentifier} from './ast-value';\nimport {Visitor} from './estree-visitor';\nimport * as esutil from './esutil';\nimport {getMethods, getOrInferPrivacy, getStaticMethods} from './esutil';\nimport {JavaScriptDocument} from './javascript-document';\nimport {JavaScriptScanner} from './javascript-scanner';\nimport * as jsdoc from './jsdoc';\n\n\n/**\n * Represents the first argument of a call to customElements.define.\n */\ntype TagNameExpression = ClassDotIsExpression|StringLiteralExpression;\n\n/** The tagname was the `is` property on an class, like `MyElem.is` */\ninterface ClassDotIsExpression {\n  type: 'is';\n  className: string;\n  classNameSourceRange: SourceRange;\n}\n/** The tag name was just a string literal. */\ninterface StringLiteralExpression {\n  type: 'string-literal';\n  value: string;\n  sourceRange: SourceRange;\n}\n\n\nexport interface ScannedAttribute extends ScannedFeature {\n  name: string;\n  type?: string;\n}\n\n/**\n * Find and classify classes from source code.\n *\n * Currently this has a bunch of Polymer stuff baked in that shouldn't be here\n * in order to support generating only one feature for stuff that's essentially\n * more specific kinds of classes, like Elements, PolymerElements, Mixins, etc.\n *\n * In a future change we'll add a mechanism whereby plugins can claim and\n * specialize classes.\n */\nexport class ClassScanner implements JavaScriptScanner {\n  async scan(\n      document: JavaScriptDocument,\n      visit: (visitor: Visitor) => Promise<void>) {\n    const classFinder = new ClassFinder(document);\n    const mixinFinder = new MixinVisitor(document);\n    const elementDefinitionFinder =\n        new CustomElementsDefineCallFinder(document);\n    // Find all classes and all calls to customElements.define()\n    await Promise.all([\n      visit(classFinder),\n      visit(elementDefinitionFinder),\n      visit(mixinFinder)\n    ]);\n    const mixins = mixinFinder.mixins;\n\n    const elementDefinitionsByClassName = new Map<string, ElementDefineCall>();\n    // For classes that show up as expressions in the second argument position\n    // of a customElements.define call.\n    const elementDefinitionsByClassExpression =\n        new Map<estree.ClassExpression, ElementDefineCall>();\n\n    for (const defineCall of elementDefinitionFinder.calls) {\n      // MaybeChainedIdentifier is invented below. It's like Identifier, but it\n      // includes 'Polymer.Element' as a name.\n      if (defineCall.class_.type === 'MaybeChainedIdentifier') {\n        elementDefinitionsByClassName.set(defineCall.class_.name, defineCall);\n      } else {\n        elementDefinitionsByClassExpression.set(defineCall.class_, defineCall);\n      }\n    }\n    // TODO(rictic): emit ElementDefineCallFeatures for define calls that don't\n    //     map to any local classes?\n\n    const mixinClassExpressions = new Set<estree.Node>();\n    for (const mixin of mixins) {\n      if (mixin.classAstNode) {\n        mixinClassExpressions.add(mixin.classAstNode);\n      }\n    }\n\n    // Next we want to distinguish custom elements from other classes.\n    const customElements: CustomElementDefinition[] = [];\n    const normalClasses = [];\n    for (const class_ of classFinder.classes) {\n      if (mixinClassExpressions.has(class_.astNode)) {\n        // This class is a mixin and has already been handled as such.\n        continue;\n      }\n      // Class expressions inside the customElements.define call\n      if (class_.astNode.type === 'ClassExpression') {\n        const definition =\n            elementDefinitionsByClassExpression.get(class_.astNode);\n        if (definition) {\n          customElements.push({class_, definition});\n          continue;\n        }\n      }\n      // Classes whose names are referenced in a same-file customElements.define\n      const definition = elementDefinitionsByClassName.get(class_.name!) ||\n          elementDefinitionsByClassName.get(class_.localName!);\n      if (definition) {\n        customElements.push({class_, definition});\n        continue;\n      }\n      // Classes explicitly defined as elements in their jsdoc tags.\n      // TODO(justinfagnani): remove @polymerElement support\n      if (jsdoc.hasTag(class_.jsdoc, 'customElement') ||\n          jsdoc.hasTag(class_.jsdoc, 'polymerElement')) {\n        customElements.push({class_});\n        continue;\n      }\n      // Classes that aren't custom elements, or at least, aren't obviously.\n      normalClasses.push(class_);\n    }\n\n    const scannedFeatures: (ScannedPolymerElement|ScannedClass|\n                            ScannedPolymerElementMixin)[] = [];\n    for (const element of customElements) {\n      scannedFeatures.push(this._makeElementFeature(element, document));\n    }\n    for (const scannedClass of normalClasses) {\n      scannedFeatures.push(scannedClass);\n    }\n    for (const mixin of mixins) {\n      scannedFeatures.push(mixin);\n    }\n\n    return {\n      features: scannedFeatures,\n      warnings: [\n        ...elementDefinitionFinder.warnings,\n        ...classFinder.warnings,\n        ...mixinFinder.warnings,\n      ]\n    };\n  }\n\n  private _makeElementFeature(\n      element: CustomElementDefinition,\n      document: JavaScriptDocument): ScannedPolymerElement {\n    const class_ = element.class_;\n    const astNode = element.class_.astNode;\n    const docs = element.class_.jsdoc;\n    let tagName: string|undefined = undefined;\n    // TODO(rictic): support `@customElements explicit-tag-name` from jsdoc\n    if (element.definition &&\n        element.definition.tagName.type === 'string-literal') {\n      tagName = element.definition.tagName.value;\n    } else if (\n        astNode.type === 'ClassExpression' ||\n        astNode.type === 'ClassDeclaration') {\n      tagName = getIsValue(astNode);\n    }\n    let warnings: Warning[] = [];\n\n    let scannedElement: ScannedPolymerElement;\n    let properties: ScannedProperty[] = [];\n    let methods = new Map<string, ScannedMethod>();\n    let staticMethods = new Map<string, ScannedMethod>();\n    let observers: Observer[] = [];\n\n    // This will cover almost all classes, except those defined only by\n    // applying a mixin. e.g.   const MyElem = Mixin(HTMLElement)\n    if (astNode.type === 'ClassExpression' ||\n        astNode.type === 'ClassDeclaration') {\n      const observersResult = this._getObservers(astNode, document);\n      observers = [];\n      if (observersResult) {\n        observers = observersResult.observers;\n        warnings = warnings.concat(observersResult.warnings);\n      }\n      properties = getPolymerProperties(astNode, document);\n      methods = getMethods(astNode, document);\n      staticMethods = getStaticMethods(astNode, document);\n    }\n\n    const extendsTag = jsdoc.getTag(docs, 'extends');\n    const extends_ = extendsTag !== undefined ? extendsTag.name : undefined;\n\n    // TODO(justinfagnani): Infer mixin applications and superclass from AST.\n    scannedElement = new ScannedPolymerElement({\n      className: class_.name,\n      tagName,\n      astNode,\n      properties,\n      methods,\n      staticMethods,\n      observers,\n      events: esutil.getEventComments(astNode),\n      attributes: new Map(),\n      behaviors: [],\n      extends: extends_,\n      listeners: [],\n\n      description: class_.description,\n      sourceRange: class_.sourceRange,\n      superClass: class_.superClass,\n      jsdoc: class_.jsdoc,\n      abstract: class_.abstract,\n      mixins: class_.mixins,\n      privacy: class_.privacy\n    });\n\n    if (astNode.type === 'ClassExpression' ||\n        astNode.type === 'ClassDeclaration') {\n      const observedAttributes = this._getObservedAttributes(astNode, document);\n\n      if (observedAttributes != null) {\n        // If a class defines observedAttributes, it overrides what the base\n        // classes defined.\n        // TODO(justinfagnani): define and handle composition patterns.\n        scannedElement.attributes.clear();\n        for (const attr of observedAttributes) {\n          scannedElement.attributes.set(attr.name, attr);\n        }\n      }\n    }\n\n    warnings.forEach((w) => scannedElement.warnings.push(w));\n\n    return scannedElement;\n  }\n\n  private _getObservers(\n      node: estree.ClassDeclaration|estree.ClassExpression,\n      document: JavaScriptDocument) {\n    const returnedValue = getStaticGetterValue(node, 'observers');\n    if (returnedValue) {\n      return extractObservers(returnedValue, document);\n    }\n  }\n\n  private _getObservedAttributes(\n      node: estree.ClassDeclaration|estree.ClassExpression,\n      document: JavaScriptDocument) {\n    const returnedValue = getStaticGetterValue(node, 'observedAttributes');\n    if (returnedValue && returnedValue.type === 'ArrayExpression') {\n      return this._extractAttributesFromObservedAttributes(\n          returnedValue, document);\n    }\n  }\n\n  /**\n   * Extract attributes from the array expression inside a static\n   * observedAttributes method.\n   *\n   * e.g.\n   *     static get observedAttributes() {\n   *       return [\n   *         /** @type {boolean} When given the element is totally inactive *\\/\n   *         'disabled',\n   *         /** @type {boolean} When given the element is expanded *\\/\n   *         'open'\n   *       ];\n   *     }\n   */\n  private _extractAttributesFromObservedAttributes(\n      arry: estree.ArrayExpression, document: JavaScriptDocument) {\n    const results: ScannedAttribute[] = [];\n    for (const expr of arry.elements) {\n      const value = astValue.expressionToValue(expr);\n      if (value && typeof value === 'string') {\n        let description = '';\n        let type: string|null = null;\n        const comment = esutil.getAttachedComment(expr);\n        if (comment) {\n          const annotation = jsdoc.parseJsdoc(comment);\n          description = annotation.description || description;\n          const tags = annotation.tags || [];\n          for (const tag of tags) {\n            if (tag.title === 'type') {\n              type = type || doctrine.type.stringify(tag.type!);\n            }\n            // TODO(justinfagnani): this appears wrong, any tag could have a\n            // description do we really let any tag's description override\n            // the previous?\n            description = description || tag.description || '';\n          }\n        }\n        const attribute: ScannedAttribute = {\n          name: value,\n          description: description,\n          sourceRange: document.sourceRangeForNode(expr),\n          astNode: expr,\n          warnings: [],\n        };\n        if (type) {\n          attribute.type = type;\n        }\n        results.push(attribute);\n      }\n    }\n    return results;\n  }\n}\n\ninterface CustomElementDefinition {\n  class_: ScannedClass;\n  definition?: ElementDefineCall;\n}\n\n/**\n * Finds all classes and matches them up with their best jsdoc comment.\n */\nclass ClassFinder implements Visitor {\n  readonly classes: ScannedClass[] = [];\n  readonly warnings: Warning[] = [];\n  private readonly alreadyMatched = new Set<estree.ClassExpression>();\n  private readonly _document: JavaScriptDocument;\n\n  constructor(document: JavaScriptDocument) {\n    this._document = document;\n  }\n\n  enterAssignmentExpression(\n      node: estree.AssignmentExpression, parent: estree.Node) {\n    this.handleGeneralAssignment(\n        astValue.getIdentifierName(node.left), node.right, node, parent);\n  }\n\n  enterVariableDeclarator(\n      node: estree.VariableDeclarator, parent: estree.Node) {\n    if (node.init) {\n      this.handleGeneralAssignment(\n          astValue.getIdentifierName(node.id), node.init, node, parent);\n    }\n  }\n\n  /** Generalizes over variable declarators and assignment expressions. */\n  private handleGeneralAssignment(\n      assignedName: string|undefined, value: estree.Expression,\n      assignment: estree.VariableDeclarator|estree.AssignmentExpression,\n      statement: estree.Node) {\n    const comment = esutil.getAttachedComment(value) ||\n        esutil.getAttachedComment(assignment) ||\n        esutil.getAttachedComment(statement) || '';\n    const doc = jsdoc.parseJsdoc(comment);\n    if (value.type === 'ClassExpression') {\n      const name =\n          assignedName || value.id && astValue.getIdentifierName(value.id);\n\n      this._classFound(name, doc, value);\n    } else {\n      // TODO(justinfagnani): remove @polymerElement support\n      if (jsdoc.hasTag(doc, 'customElement') ||\n          jsdoc.hasTag(doc, 'polymerElement')) {\n        this._classFound(assignedName, doc, value);\n      }\n    }\n  }\n\n  enterClassExpression(node: estree.ClassExpression, parent: estree.Node) {\n    // Class expressions may be on the right hand side of assignments, so\n    // we may have already handled this expression from the parent or\n    // grandparent node. Class declarations can't be on the right hand side of\n    // assignments, so they'll definitely only be handled once.\n    if (this.alreadyMatched.has(node)) {\n      return;\n    }\n\n    const name = node.id ? astValue.getIdentifierName(node.id) : undefined;\n    const comment = esutil.getAttachedComment(node) ||\n        esutil.getAttachedComment(parent) || '';\n    this._classFound(name, jsdoc.parseJsdoc(comment), node);\n  }\n\n  enterClassDeclaration(node: estree.ClassDeclaration, parent: estree.Node) {\n    const name = astValue.getIdentifierName(node.id);\n    const comment = esutil.getAttachedComment(node) ||\n        esutil.getAttachedComment(parent) || '';\n    this._classFound(name, jsdoc.parseJsdoc(comment), node);\n  }\n\n  private _classFound(\n      name: string|undefined, doc: jsdoc.Annotation, astNode: estree.Node) {\n    const namespacedName = name && getNamespacedIdentifier(name, doc);\n\n    const warnings: Warning[] = [];\n    // TODO(rictic): scan the constructor and look for assignments to this.foo\n    //     to determine properties.\n    this.classes.push(new ScannedClass(\n        namespacedName,\n        name,\n        astNode,\n        doc,\n        (doc.description || '').trim(),\n        this._document.sourceRangeForNode(astNode)!,\n        new Map(),\n        getMethods(astNode, this._document),\n        getStaticMethods(astNode, this._document),\n        this._getExtends(astNode, doc, warnings, this._document),\n        jsdoc.getMixinApplications(this._document, astNode, doc, warnings),\n        getOrInferPrivacy(namespacedName || '', doc),\n        warnings,\n        jsdoc.hasTag(doc, 'abstract'),\n        jsdoc.extractDemos(doc)));\n    if (astNode.type === 'ClassExpression') {\n      this.alreadyMatched.add(astNode);\n    }\n  }\n\n  /**\n   * Returns the name of the superclass, if any.\n   */\n  private _getExtends(\n      node: estree.Node, docs: jsdoc.Annotation, warnings: Warning[],\n      document: JavaScriptDocument): ScannedReference|undefined {\n    const extendsAnnotations =\n        docs.tags!.filter((tag) => tag.title === 'extends');\n\n    // prefer @extends annotations over extends clauses\n    if (extendsAnnotations.length > 0) {\n      const extendsId = extendsAnnotations[0].name;\n      // TODO(justinfagnani): we need source ranges for jsdoc annotations\n      const sourceRange = document.sourceRangeForNode(node)!;\n      if (extendsId == null) {\n        warnings.push(new Warning({\n          code: 'class-extends-annotation-no-id',\n          message: '@extends annotation with no identifier',\n          severity: Severity.WARNING, sourceRange,\n          parsedDocument: this._document\n        }));\n      } else {\n        return new ScannedReference(extendsId, sourceRange);\n      }\n    } else if (\n        node.type === 'ClassDeclaration' || node.type === 'ClassExpression') {\n      // If no @extends tag, look for a superclass.\n      const superClass = node.superClass;\n      if (superClass != null) {\n        const extendsId = getIdentifierName(superClass);\n        if (extendsId != null) {\n          const sourceRange = document.sourceRangeForNode(superClass)!;\n          return new ScannedReference(extendsId, sourceRange);\n        }\n      }\n    }\n  }\n}\n\ninterface ElementDefineCall {\n  tagName: TagNameExpression;\n  class_: ElementClassExpression;\n}\n\ntype ElementClassExpression = estree.ClassExpression|{\n  type: 'MaybeChainedIdentifier';\n  name: string, sourceRange: SourceRange\n};\n\n/** Finds calls to customElements.define() */\nclass CustomElementsDefineCallFinder implements Visitor {\n  readonly warnings: Warning[] = [];\n  readonly calls: ElementDefineCall[] = [];\n  private readonly _document: JavaScriptDocument;\n\n  constructor(document: JavaScriptDocument) {\n    this._document = document;\n  }\n\n  enterCallExpression(node: estree.CallExpression) {\n    const callee = astValue.getIdentifierName(node.callee);\n    if (!(callee === 'window.customElements.define' ||\n          callee === 'customElements.define')) {\n      return;\n    }\n\n    const tagNameExpression = this._getTagNameExpression(node.arguments[0]);\n    if (tagNameExpression == null) {\n      return;\n    }\n    const elementClassExpression =\n        this._getElementClassExpression(node.arguments[1]);\n    if (elementClassExpression == null) {\n      return;\n    }\n    this.calls.push(\n        {tagName: tagNameExpression, class_: elementClassExpression});\n  }\n\n  private _getTagNameExpression(expression: estree.Node|\n                                undefined): TagNameExpression|undefined {\n    if (expression == null) {\n      return;\n    }\n    const tryForLiteralString = astValue.expressionToValue(expression);\n    if (tryForLiteralString != null &&\n        typeof tryForLiteralString === 'string') {\n      return {\n        type: 'string-literal',\n        value: tryForLiteralString,\n        sourceRange: this._document.sourceRangeForNode(expression)!\n      };\n    }\n    if (expression.type === 'MemberExpression') {\n      // Might be something like MyElement.is\n      const isPropertyNameIs = (expression.property.type === 'Identifier' &&\n                                expression.property.name === 'is') ||\n          (astValue.expressionToValue(expression.property) === 'is');\n      const className = astValue.getIdentifierName(expression.object);\n      if (isPropertyNameIs && className) {\n        return {\n          type: 'is',\n          className,\n          classNameSourceRange:\n              this._document.sourceRangeForNode(expression.object)!\n        };\n      }\n    }\n    this.warnings.push(new Warning({\n      code: 'cant-determine-element-tagname',\n      message:\n          `Unable to evaluate this expression down to a definitive string ` +\n          `tagname.`,\n      severity: Severity.WARNING,\n      sourceRange: this._document.sourceRangeForNode(expression)!,\n      parsedDocument: this._document\n    }));\n    return undefined;\n  }\n\n  private _getElementClassExpression(elementDefn: estree.Node|\n                                     undefined): ElementClassExpression|null {\n    if (elementDefn == null) {\n      return null;\n    }\n    const className = astValue.getIdentifierName(elementDefn);\n    if (className) {\n      return {\n        type: 'MaybeChainedIdentifier',\n        name: className,\n        sourceRange: this._document.sourceRangeForNode(elementDefn)!\n      };\n    }\n    if (elementDefn.type === 'ClassExpression') {\n      return elementDefn;\n    }\n    this.warnings.push(new Warning({\n      code: 'cant-determine-element-class',\n      message: `Unable to evaluate this expression down to a class reference.`,\n      severity: Severity.WARNING,\n      sourceRange: this._document.sourceRangeForNode(elementDefn)!,\n      parsedDocument: this._document,\n    }));\n    return null;\n  }\n}\n"]}